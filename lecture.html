<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>College SMS - Lecturers Management</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
  <div class="container mt-4">
    <h2 class="text-center mb-4">Lecturers Management</h2>

    <!-- Form -->
    <div class="card p-3 shadow-sm">
      <h5>Add Lecturer</h5>
      <form id="lecturerForm">
        <div class="row g-3">
          <div class="col-md-6">
            <input type="text" id="lecturerName" class="form-control" placeholder="Full Name" required>
          </div>
          <div class="col-md-6">
            <input type="text" id="lecturerDept" class="form-control" placeholder="Department" required>
          </div>
          <div class="col-md-6">
            <input type="email" id="lecturerEmail" class="form-control" placeholder="Email" required>
          </div>
          <div class="col-md-6">
            <input type="text" id="lecturerPhone" class="form-control" placeholder="Phone" required>
          </div>
        </div>
        <button type="submit" class="btn btn-success mt-3">Add Lecturer</button>
      </form>
    </div>

    <!-- Table -->
    <div class="card p-3 mt-4 shadow-sm">
      <h5>Lecturers List</h5>
      <table class="table table-bordered mt-2">
        <thead class="table-dark">
          <tr>
            <th>Name</th>
            <th>Department</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="lecturerTable"></tbody>
      </table>
    </div>
  </div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { getDatabase, ref, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBdabXqlBQ-6yVNJKdu8Zhb9Cm_-59_u24",
      authDomain: "bett-294a2.firebaseapp.com",
      databaseURL: "https://bett-294a2-default-rtdb.firebaseio.com",
      projectId: "bett-294a2",
      storageBucket: "bett-294a2.firebasestorage.app",
      messagingSenderId: "1055511650032",
      appId: "1:1055511650032:web:7e0f9c28e58515f549ac35",
      measurementId: "G-MC0GRCLF1H"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const lecturerForm = document.getElementById("lecturerForm");
    const lecturerTable = document.getElementById("lecturerTable");
    let editId = null;

    // Add Lecturer
    lecturerForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const name = document.getElementById("lecturerName").value;
      const dept = document.getElementById("lecturerDept").value;
      const email = document.getElementById("lecturerEmail").value;
      const phone = document.getElementById("lecturerPhone").value;

      if (editId) {
        update(ref(db, "lecturers/" + editId), { name, dept, email, phone });
        editId = null;
      } else {
        push(ref(db, "lecturers"), { name, dept, email, phone });
      }

      lecturerForm.reset();
    });

    // Display Lecturers
    onValue(ref(db, "lecturers"), (snapshot) => {
      lecturerTable.innerHTML = "";
      snapshot.forEach((child) => {
        const data = child.val();
        const row = `
          <tr>
            <td>${data.name}</td>
            <td>${data.dept}</td>
            <td>${data.email}</td>
            <td>${data.phone}</td>
            <td>
              <button class="btn btn-warning btn-sm" onclick="editLecturer('${child.key}','${data.name}','${data.dept}','${data.email}','${data.phone}')">Edit</button>
              <button class="btn btn-danger btn-sm" onclick="deleteLecturer('${child.key}')">Delete</button>
            </td>
          </tr>`;
        lecturerTable.innerHTML += row;
      });
    });

    // Edit Lecturer
    window.editLecturer = (id, name, dept, email, phone) => {
      document.getElementById("lecturerName").value = name;
      document.getElementById("lecturerDept").value = dept;
      document.getElementById("lecturerEmail").value = email;
      document.getElementById("lecturerPhone").value = phone;
      editId = id;
    };

    // Delete Lecturer
    window.deleteLecturer = (id) => {
      remove(ref(db, "lecturers/" + id));
    };
  </script>
</body>
</html>